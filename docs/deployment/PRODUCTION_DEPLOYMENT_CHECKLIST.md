# üöÄ Mercenary OSINT Platform - Production Deployment Checklist

*Generated by DevOps Agent - July 3, 2025*

## üìã Pre-Deployment Status

### ‚úÖ **Completed (Ready for Production)**
- [x] Environment variables cleaned and standardized
- [x] RSS feed connectivity improved (5/6 feeds operational)
- [x] GitHub Actions workflow configured
- [x] TypeScript compilation errors resolved
- [x] Build system production-ready
- [x] Health monitoring scripts active

### ‚ö†Ô∏è **Pending (Requires Production Access)**
- [ ] Database schema deployment
- [ ] GitHub repository secrets configuration
- [ ] PostGIS extension verification
- [ ] GitHub Actions workflow activation

---

## üóÉÔ∏è **CRITICAL: Database Schema Deployment**

### **Required Action: Apply Escalation Scoring Schema**

**File to Deploy:** `database/news-table-escalation-update.sql`

**Steps:**
1. Access Supabase Dashboard ‚Üí SQL Editor
2. Copy and execute the SQL from `database/news-table-escalation-update.sql`
3. Verify deployment with test query:
   ```sql
   SELECT column_name, data_type, is_nullable 
   FROM information_schema.columns 
   WHERE table_name = 'news' AND column_name = 'escalation_score';
   ```

**Expected Result:**
```
column_name      | data_type | is_nullable
escalation_score | numeric   | YES
```

**Verification Commands:**
```sql
-- Check indexes were created
SELECT indexname FROM pg_indexes WHERE tablename = 'news' AND indexname LIKE '%escalation%';

-- Check views were created
SELECT viewname FROM pg_views WHERE viewname IN ('high_escalation_news', 'news_escalation_analytics');
```

---

## üîê **GitHub Repository Secrets Configuration**

### **Required Secrets (Repository Settings ‚Üí Secrets and variables ‚Üí Actions)**

| Secret Name | Source | Description |
|------------|--------|-------------|
| `NEXT_PUBLIC_SUPABASE_URL` | Supabase Dashboard | Project URL |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Supabase Dashboard | Anonymous/Public key |
| `SUPABASE_SERVICE_KEY` | Supabase Dashboard | Service role key (CRITICAL: Admin access) |
| `OPENAI_API_KEY` | OpenAI Dashboard | API key for content analysis |
| `SLACK_WEBHOOK_URL` | Slack App Settings | Webhook for failure notifications |
| `ALERT_EMAIL` | Configuration | Email for critical alerts |

### **Security Notes:**
- **NEVER** commit the service key to code
- Service key has full database access - guard carefully
- Rotate keys if compromised immediately

---

## üó∫Ô∏è **PostGIS Extension Verification**

### **Required Action: Confirm Geographic Capabilities**

**Steps:**
1. Access Supabase Dashboard ‚Üí SQL Editor
2. Run verification query:
   ```sql
   SELECT name, default_version, installed_version 
   FROM pg_available_extensions 
   WHERE name = 'postgis';
   ```

**Expected Result:**
- Extension should be available and installed
- Version should be 3.x or higher

**If Not Enabled:**
```sql
CREATE EXTENSION IF NOT EXISTS postgis;
```

---

## ‚öôÔ∏è **GitHub Actions Workflow Activation**

### **Manual Test Workflow**

1. Navigate to repository ‚Üí Actions tab
2. Select "OSINT News Ingestion" workflow
3. Click "Run workflow"
4. Enable "Run in dry-run mode" for first test
5. Monitor execution logs for errors

### **Schedule Verification**

- Workflow is configured to run every 30 minutes: `*/30 * * * *`
- First run should occur within 30 minutes of secrets configuration
- Check "Actions" tab for execution history

---

## üîç **Post-Deployment Verification**

### **1. Database Schema Verification**
```bash
cd osint_app
node scripts/test-escalation-features.js
```

### **2. API Endpoints Test**
```bash
# Test analytics endpoints with escalation support
curl "http://localhost:3000/api/analytics/regions"
curl "http://localhost:3000/api/analytics/timeline?days=30"
curl "http://localhost:3000/api/analytics/top-countries?limit=10"
```

### **3. RSS Ingestion Test**
```bash
cd osint_app/osint-ingestion
node runAll.js --dry-run
```

### **4. Health Check**
```bash
cd osint_app
node scripts/health-check.mjs
```

---

## üö® **Rollback Plan**

### **If Schema Deployment Fails:**
```sql
-- Remove escalation_score column if needed
ALTER TABLE news DROP COLUMN IF EXISTS escalation_score;

-- Remove indexes
DROP INDEX IF EXISTS idx_news_escalation_score;
DROP INDEX IF EXISTS idx_news_escalation_region;
DROP INDEX IF EXISTS idx_news_escalation_date;

-- Remove views
DROP VIEW IF EXISTS high_escalation_news;
DROP VIEW IF EXISTS news_escalation_analytics;
```

### **If GitHub Actions Fail:**
1. Disable workflow in repository settings
2. Check secrets configuration
3. Review workflow logs for specific errors
4. Test locally with same environment variables

---

## üìä **Success Metrics**

### **Expected Performance Post-Deployment:**
- RSS ingestion: 5/6 feeds operational (~109 articles/30min)
- API response time: <500ms for analytics endpoints
- Build time: <3 minutes
- Zero TypeScript compilation errors
- Escalation scoring: Available for all new articles

### **Monitoring Dashboards:**
- GitHub Actions execution history
- Supabase database metrics
- RSS feed health via logs

---

## üë• **Agent Handoffs**

### **Backend Agent:**
- Test escalation score analytics APIs after schema deployment
- Validate high_escalation_news view functionality
- Confirm analytics endpoints return escalation data

### **Frontend Agent:**
- Test escalation filtering in UI components
- Verify analytics dashboards display escalation metrics
- Confirm no UI breaks from new data schema

### **News Ingestion Agent:**
- Monitor escalation score persistence in database
- Verify enhanced pipeline includes scoring
- Test end-to-end: fetch ‚Üí score ‚Üí store ‚Üí retrieve

---

## üîó **Quick Reference**

- **Database Schema**: `database/news-table-escalation-update.sql`
- **GitHub Workflow**: `.github/workflows/osint-ingestion.yml`
- **Health Check**: `scripts/health-check.mjs`
- **Environment Config**: `.env.local` (local) + GitHub Secrets (production)

---

**üéØ Post-deployment, all agents should test their respective components to ensure full system integration.**